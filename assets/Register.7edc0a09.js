import{r as e,_ as a}from"./index.3253e0ab.js";import{r as l,o as t,t as r,v as s,b as o,w as i,aR as d,ax as n,aS as u,aT as m}from"./ui.9933098f.js";const c=function(e={}){let a=e.value;return"function"==typeof a&&(a=a()),e.label||(e.label={mobile:"手机号",idCard:"身份证号",tel:"电话",email:"邮箱"}[e.validType]||""),new Promise(((l,t)=>{if(null==a||!a.length)return e.required?t(`请输入${e.label}`):l();switch(e.validType){case"mobile":/^(?:(?:\+|00)86)?1\d{10}$/.test(String(a))?l():t(`${e.label}格式有误，请重新输入`);break;case"idCard":(e=>/^[1-9]\d{5}(?:18|19|20)\d{2}(?:0[1-9]|10|11|12)(?:0[1-9]|[1-2]\d|30|31)\d{3}[\dXx]$/.test(String(e)))(a)?l():t(`${e.label}格式有误，请重新输入`);break;case"tel":(e=>/^(?:(?:\d{3}-)?\d{8}|^(?:\d{4}-)?\d{7,8})(?:-\d+)?$/.test(String(e)))(a)?l():t(`${e.label}格式有误，请重新输入`);break;case"email":(e=>/^[A-Za-z0-9\u4e00-\u9fa5]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/.test(String(e)))(a)?l():t(`${e.label}格式有误，请重新输入`);break;default:t(`不支持的validType: ${e.validType}`)}}))},f={data(){return{loading:!1,formData:{mobile:null,token:null,name:null,company:null,password:null,checkPass:null,userInput:null},rules:{mobile:[{validator:()=>c({required:!0,validType:"mobile",value:()=>{var e;return null==(e=this.formData)?void 0:e.mobile}}),trigger:[]}],userInput:[{validator:()=>new Promise(((e,a)=>{this.$refs.InputSMS.valid().then((a=>{this.resData=a,e()})).catch((e=>{a(e)}))})),trigger:[]}],name:[{required:!0,message:"请输入姓名",trigger:"change"}],company:[{required:!0,message:"请输入工作单位",trigger:"change"}],password:[{validator:(e,a,l)=>{""===a?l(new Error("请输入密码")):(""!==this.formData.checkPass&&this.$refs.validForm.validateField("checkPass"),l())},trigger:"blur"},{min:6,max:30,message:"长度在 6 到 30 个字符",trigger:"blur"}],checkPass:[{validator:(e,a,l)=>{""===a?l(new Error("请再次输入密码")):a!==this.formData.password?l(new Error("两次输入密码不一致!")):l()},trigger:"blur"}]},resData:null}},methods:{sendValidCode(){this.$refs.validForm.validateField("mobile",(e=>{e||this.$refs.InputSMS.send()}))},register(){if(this.loading)return null;this.loading=!0,this.$refs.validForm.validate((async a=>{a?(this.formData.token=this.resData,e(this.formData).then((e=>{this.loading=!1,200===e.status?this.$alert("注册成功,请登录","注册成功",{confirmButtonText:"确定",callback:()=>{this.$router.replace({name:"登录"})}}):this.$message.error(e.data.message)})).catch((()=>{this.loading=!1}))):this.loading=!1}))}},created(){}},p=e=>(u("data-v-d3236c7b"),e=e(),m(),e),b={class:"flex-row align-center justify-center registerPage"},g={class:"register-box"},h=p((()=>s("div",{class:"title"},"注册账号",-1))),v={class:"flex-row"},D=p((()=>s("div",{class:"flex-1"},null,-1)));const y=a(f,[["render",function(e,a,u,m,c,f){const p=l("el-input"),y=l("el-form-item"),k=l("InputSMS"),$=l("InputPassword"),w=l("el-button"),V=l("el-form"),S=l("el-link"),_=l("auth");return t(),r("div",b,[s("div",g,[h,o(V,{ref:"validForm",model:c.formData,rules:c.rules,"label-width":"100px","hide-required-asterisk":"",onSubmit:d(f.register,["prevent"]),size:"medium"},{default:i((()=>[o(y,{prop:"mobile",required:"",label:"手机号："},{default:i((()=>[o(p,{modelValue:c.formData.mobile,"onUpdate:modelValue":a[0]||(a[0]=e=>c.formData.mobile=e)},null,8,["modelValue"])])),_:1}),o(y,{prop:"userInput",label:"验证码："},{default:i((()=>[o(k,{ref:"InputSMS",type:"register",mobile:c.formData.mobile,onClick:f.sendValidCode},null,8,["mobile","onClick"])])),_:1}),o(y,{prop:"name",label:"姓名："},{default:i((()=>[o(p,{modelValue:c.formData.name,"onUpdate:modelValue":a[1]||(a[1]=e=>c.formData.name=e),modelModifiers:{trim:!0}},null,8,["modelValue"])])),_:1}),o(y,{prop:"company",label:"工作单位："},{default:i((()=>[o(p,{modelValue:c.formData.company,"onUpdate:modelValue":a[2]||(a[2]=e=>c.formData.company=e),modelModifiers:{trim:!0}},null,8,["modelValue"])])),_:1}),o(y,{prop:"password",label:"设置密码："},{default:i((()=>[o($,{modelValue:c.formData.password,"onUpdate:modelValue":a[3]||(a[3]=e=>c.formData.password=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),o(y,{prop:"checkPass",label:"重复密码："},{default:i((()=>[o(p,{type:"password",modelValue:c.formData.checkPass,"onUpdate:modelValue":a[4]||(a[4]=e=>c.formData.checkPass=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),o(y,{class:"submit-item"},{default:i((()=>[o(w,{"native-type":"submit",class:"submit-button",type:"primary",loading:c.loading},{default:i((()=>[n("确 认")])),_:1},8,["loading"])])),_:1})])),_:1},8,["model","rules","onSubmit"]),s("div",v,[D,n(" 已有账号？"),o(S,{type:"danger",class:"first",onClick:a[5]||(a[5]=a=>e.$router.push({name:"登录"}))},{default:i((()=>[n(" 点击登录 ")])),_:1})])]),o(_,{ref:"auth",types:["captcha"]},null,512)])}],["__scopeId","data-v-d3236c7b"]]);export{y as default};
