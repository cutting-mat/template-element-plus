import{_ as e,d as l,a}from"./index.a7704b88.js";import{r as i,a as t,e as o,b as s,l as r}from"./role.e23e7c83.js";import{q as d,r as n,aX as m,aY as c,o as u,t as h,b as f,w as g,a as p,ax as b}from"./ui.7155d707.js";const k={components:{TheResourcePicker:d((()=>a((()=>import("./TheResourcePicker.4ed5f53e.js")),["assets/TheResourcePicker.4ed5f53e.js","assets/TheResourcePicker.55cef8ca.css","assets/index.a7704b88.js","assets/index.43470bb7.css","assets/ui.7155d707.js","assets/resource.d8f51d3a.js"])))},data:()=>({role:i,dialogVisible:!1,loading:!1,list:[],editForm:{name:"",remark:"",resources:[]},rules:{name:[{required:!0,message:"请输入角色名称",trigger:"blur"},{min:1,max:100,message:"长度 1 到 100 个字符",trigger:"blur"}],remark:[{min:0,max:255,message:"长度 0 到 255 个字符",trigger:"blur"}]}}),methods:{edit(e){this.editForm=l(e),this.editForm.resources=e.resources,this.dialogVisible=!0},save(){this.$refs.editForm.validate((e=>{if(e){this.loading=!0;let e=l(this.editForm);this.handleCloseDialog(),(e.id?o:t)(e).then((()=>{this.fetchData(),this.$message({message:"添加成功",type:"success"})})).catch((()=>{this.loading=!1}))}}))},handleCloseDialog:function(){this.dialogVisible=!1,this.editForm={name:"",remark:"",resources:[]},this.$refs.editForm&&this.$refs.editForm.resetFields()},remove(e){if(!e||!e.id)return null;this.$confirm("是否删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.loading=!0,s({id:e.id}).then((()=>{this.fetchData(),this.$message({message:"删除成功",type:"success"})})).catch((()=>{this.loading=!1}))}))},fetchData:function(){this.loading=!0,r().then((e=>{this.loading=!1,this.list=e.data})).catch((()=>{this.loading=!1}))}},created:function(){this.fetchData()}},_={class:"scrollbar"},F=b(" 添加 "),V=b("编辑"),C=b("删除"),x=b("确 定"),y=b("取 消");const D=e(k,[["render",function(e,l,a,i,t,o){const s=n("plus"),r=n("el-icon"),d=n("el-button"),b=n("ToolBar"),k=n("el-table-column"),D=n("el-table"),w=n("el-input"),v=n("el-form-item"),T=n("TheResourcePicker"),$=n("el-form"),j=n("el-dialog"),P=m("auth"),R=m("loading");return c((u(),h("div",_,[f(b,null,{default:g((()=>[c((u(),p(d,{type:"primary",onClick:l[0]||(l[0]=e=>t.dialogVisible=!0)},{default:g((()=>[f(r,null,{default:g((()=>[f(s)])),_:1}),F])),_:1})),[[P,t.role.add]])])),_:1}),f(D,{data:t.list,style:{width:"100%"}},{default:g((()=>[f(k,{prop:"name",label:"角色名称",align:"center"}),f(k,{prop:"remark",label:"备注"}),f(k,{label:"操作",width:"300",align:"center"},{default:g((e=>[c((u(),p(d,{type:"info",plain:"",onClick:l=>o.edit(e.row)},{default:g((()=>[V])),_:2},1032,["onClick"])),[[P,t.role.edit]]),c((u(),p(d,{type:"danger",plain:"",onClick:l=>o.remove(e.row)},{default:g((()=>[C])),_:2},1032,["onClick"])),[[P,t.role.remove]])])),_:1})])),_:1},8,["data"]),f(j,{"close-on-click-modal":!1,"custom-class":"comDialog",title:"权限信息",modelValue:t.dialogVisible,"onUpdate:modelValue":l[5]||(l[5]=e=>t.dialogVisible=e),width:"600px",onClose:o.handleCloseDialog},{footer:g((()=>[f(d,{type:"primary",onClick:o.save},{default:g((()=>[x])),_:1},8,["onClick"]),f(d,{onClick:l[4]||(l[4]=e=>t.dialogVisible=!1)},{default:g((()=>[y])),_:1})])),default:g((()=>[f($,{ref:"editForm",rules:t.rules,model:t.editForm,"label-width":"80px"},{default:g((()=>[f(v,{label:"角色名称",prop:"name"},{default:g((()=>[f(w,{modelValue:t.editForm.name,"onUpdate:modelValue":l[1]||(l[1]=e=>t.editForm.name=e),modelModifiers:{trim:!0},maxlength:100},null,8,["modelValue"])])),_:1}),f(v,{label:"备注",prop:"remark"},{default:g((()=>[f(w,{modelValue:t.editForm.remark,"onUpdate:modelValue":l[2]||(l[2]=e=>t.editForm.remark=e),modelModifiers:{trim:!0},type:"textarea",maxlength:1e3},null,8,["modelValue"])])),_:1}),f(v,{label:"权限"},{default:g((()=>[f(T,{picker:"",checked:t.editForm.resources,onCheck:l[3]||(l[3]=e=>t.editForm.resources=e.map((e=>e.id)))},null,8,["checked"])])),_:1})])),_:1},8,["rules","model"])])),_:1},8,["modelValue","onClose"])])),[[R,t.loading]])}]]);export{D as default};
