import{_ as e,D as l,d as a,r as i,B as o,C as t,o as s,c as d,e as r,w as n,g as m,h as u,k as g,a as c,l as f}from"./index.cc0542f8.js";import{o as h,a as p,e as _,r as V}from"./org.22e24e45.js";const b={components:{OrgTree:l((()=>c((()=>import("./OrgTree.0592e6d5.js")),["assets/OrgTree.0592e6d5.js","assets/org.22e24e45.js","assets/index.cc0542f8.js","assets/index.43470bb7.css"])))},data:()=>({org:h,dialogVisible:!1,sourceDepart:null,loading:!1,list:[],queryParam:{},editForm:{name:"",pid:null},rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"},{min:1,max:100,message:"长度 1 到 100 个字符",trigger:"blur"}],fullName:[{min:0,max:255,message:"长度 0 到 255 个字符",trigger:"blur"}]},refresh:!0}),methods:{edit(e){this.editForm=a(e),this.dialogVisible=!0},add(e){this.editForm={pid:e.pid},this.dialogVisible=!0},save(){let e=this;e.$refs.editForm.validate((l=>{if(l){let l=a(e.editForm);this.handleCloseDialog(),l.id?_(l).then((()=>{e.fetchData(),e.$message({message:"编辑成功",type:"success"})})):p(l).then((()=>{e.fetchData(),e.$message({message:"添加成功",type:"success"})}))}}))},handleCloseDialog:function(){this.dialogVisible=!1,this.editForm={name:"",pid:null}},remove(e){if(!e||!e.id)return null;this.$confirm("是否删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.loading=!0,V({id:e.id}).then((()=>{this.loading=!1,this.fetchData(),this.$message({message:"删除成功",type:"success"})})).catch((()=>{this.loading=!1}))}))},fetchData(){this.refresh=!1,this.$nextTick((()=>{this.refresh=!0}))}}},C={class:"scrollbar"},k=f(" 添加根节点 "),F=f("编辑"),y=f("添加下级"),D=f("删除"),v=f("确 定"),x=f("取 消");const T=e(b,[["render",function(e,l,a,c,f,h){const p=i("plus"),_=i("el-icon"),V=i("el-button"),b=i("ToolBar"),T=i("OrgTree"),w=i("el-input"),$=i("el-form-item"),B=i("el-form"),N=i("el-dialog"),O=o("auth"),j=o("loading");return t((s(),d("div",C,[r(b,null,{default:n((()=>[t((s(),m(V,{type:"primary",onClick:l[0]||(l[0]=e=>f.dialogVisible=!0)},{default:n((()=>[r(_,null,{default:n((()=>[r(p)])),_:1}),k])),_:1})),[[O,f.org.add]])])),_:1}),f.refresh?(s(),m(T,{key:0},{action:n((e=>[g("div",null,[t((s(),m(V,{onClick:l=>h.edit(e.row)},{default:n((()=>[F])),_:2},1032,["onClick"])),[[O,f.org.edit]]),t((s(),m(V,{onClick:l=>h.add(e.row)},{default:n((()=>[y])),_:2},1032,["onClick"])),[[O,f.org.add]]),t((s(),m(V,{type:"danger",plain:"",onClick:l=>h.remove(e.row)},{default:n((()=>[D])),_:2},1032,["onClick"])),[[O,f.org.remove]])])])),_:1})):u("",!0),r(N,{modelValue:f.dialogVisible,"onUpdate:modelValue":l[5]||(l[5]=e=>f.dialogVisible=e),title:"组织信息",width:"800px","close-on-click-modal":!1,onClose:h.handleCloseDialog},{footer:n((()=>[g("div",null,[r(V,{type:"primary",onClick:l[3]||(l[3]=e=>h.save())},{default:n((()=>[v])),_:1}),r(V,{onClick:l[4]||(l[4]=e=>f.dialogVisible=!1)},{default:n((()=>[x])),_:1})])])),default:n((()=>[r(B,{ref:"editForm",rules:f.rules,model:f.editForm,"label-width":"150px"},{default:n((()=>[r($,{label:"部门名称",prop:"name"},{default:n((()=>[r(w,{modelValue:f.editForm.name,"onUpdate:modelValue":l[1]||(l[1]=e=>f.editForm.name=e)},null,8,["modelValue"])])),_:1}),r($,{label:"全称",prop:"fullName"},{default:n((()=>[r(w,{modelValue:f.editForm.fullName,"onUpdate:modelValue":l[2]||(l[2]=e=>f.editForm.fullName=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["rules","model"])])),_:1},8,["modelValue","onClose"])])),[[j,f.loading]])}]]);export{T as default};
