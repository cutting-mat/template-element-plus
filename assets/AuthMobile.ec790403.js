import{_ as b,O as M,P as v,r as s,o as p,g as _,w as l,l as m,t as V,h as w,e as n,N as y}from"./index.bb69c137.js";const C={data(){return{loading:!1,formData:{id:null,userInput:null,inputMobile:null},rules:{inputMobile:[{validator:(e,r,o)=>{if(!r)o(new Error("\u8BF7\u8F93\u5165\u7ED1\u5B9A\u624B\u673A"));else{if(this.userMobile){if(this.userMobile!==r)return o(new Error("\u624B\u673A\u53F7\u4E0D\u6B63\u786E"))}else return y({mobile:r}).then(t=>{t.data?(this.accountInfo=t.data,o()):o(new Error("\u624B\u673A\u53F7\u4E0D\u5B58\u5728"))});o()}},trigger:[]}],userInput:[{required:!0,message:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",trigger:"blur"},{min:4,max:6,message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u9A8C\u8BC1\u7801",trigger:"blur"}]},accountInfo:null}},computed:{userMobile(){return String(this.$store.state.user.contactNumber||"")},anonymousMobile(){if(this.userMobile){const i=this.userMobile.split("");return`${i.map((r,o)=>o<3||i.length-o<3?r:"*").join("")}`}return""}},methods:{sendValidCode(){this.$refs.form.validateField("inputMobile",i=>{i&&(this.loading=!0,M({mobile:this.formData.inputMobile}).then(e=>{this.loading=!1,e.status===200?(this.formData.id=e.data.id,this.$refs.countdownButton.start()):this.$message.warning("\u9A8C\u8BC1\u7801\u53D1\u9001\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5")}).catch(()=>{this.loading=!1}))})},handleSubmit(){this.$refs.form.validateField("userInput",i=>{i&&(this.loading=!0,v(this.formData).then(e=>{this.loading=!1,e.status===200?this.$emit("success",e.data,this.accountInfo):(this.$refs.form.resetFields(),this.$message.warning("\u9A8C\u8BC1\u5931\u8D25"))}).catch(()=>{this.loading=!1}))})}}},D=m(" \u83B7\u53D6\u9A8C\u8BC1\u7801 "),I=m(" \u7ACB\u5373\u9A8C\u8BC1 ");function x(i,e,r,o,t,a){const u=s("el-form-item"),f=s("el-input"),c=s("countdownButton"),h=s("el-button"),g=s("el-form");return p(),_(g,{ref:"form",model:t.formData,rules:t.rules,"label-position":"left",class:"auth_mobile","v-loading":t.loading},{default:l(()=>[a.anonymousMobile?(p(),_(u,{key:0},{default:l(()=>[m("\u7ED1\u5B9A\u624B\u673A\uFF1A"+V(a.anonymousMobile),1)]),_:1})):w("",!0),n(u,{prop:"inputMobile"},{default:l(()=>[n(f,{size:"large",modelValue:t.formData.inputMobile,"onUpdate:modelValue":e[0]||(e[0]=d=>t.formData.inputMobile=d),placeholder:"\u8BF7\u8F93\u5165\u7ED1\u5B9A\u624B\u673A"},null,8,["modelValue"])]),_:1}),n(u,{prop:"userInput"},{default:l(()=>[n(f,{size:"large",modelValue:t.formData.userInput,"onUpdate:modelValue":e[1]||(e[1]=d=>t.formData.userInput=d),placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"},{append:l(()=>[n(c,{ref:"countdownButton",count:30,onClick:a.sendValidCode},{default:l(()=>[D]),_:1},8,["onClick"])]),_:1},8,["modelValue"])]),_:1}),n(u,null,{default:l(()=>[n(h,{type:"primary",size:"large",style:{width:"100%"},onClick:a.handleSubmit},{default:l(()=>[I]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules","v-loading"])}var E=b(C,[["render",x],["__scopeId","data-v-b4837878"]]);export{E as default};
