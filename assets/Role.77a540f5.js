import{_ as B,C as A,d as k,r,A as b,B as m,o as c,c as P,e as o,w as l,a as R,g as h,l as a}from"./index.07ef7170.js";import{r as E,a as U,e as M,b as N,l as q}from"./role.4ec26c06.js";const I={components:{TheResourcePicker:A(()=>R(()=>import("./TheResourcePicker.be118496.js"),["assets/TheResourcePicker.be118496.js","assets/TheResourcePicker.7f8a1f38.css","assets/index.07ef7170.js","assets/index.39d4a6ad.css","assets/resource.6b119af7.js"]))},data(){return{role:E,dialogVisible:!1,loading:!1,list:[],editForm:{name:"",remark:"",resources:[]},rules:{name:[{required:!0,message:"\u8BF7\u8F93\u5165\u89D2\u8272\u540D\u79F0",trigger:"blur"},{min:1,max:100,message:"\u957F\u5EA6 1 \u5230 100 \u4E2A\u5B57\u7B26",trigger:"blur"}],remark:[{min:0,max:255,message:"\u957F\u5EA6 0 \u5230 255 \u4E2A\u5B57\u7B26",trigger:"blur"}]}}},methods:{edit(s){this.editForm=k(s),this.editForm.resources=s.resources,this.dialogVisible=!0},save(){this.$refs.editForm.validate(s=>{if(s){this.loading=!0;let t=k(this.editForm);this.handleCloseDialog(),(t.id?M:U)(t).then(()=>{this.fetchData(),this.$message({message:"\u6DFB\u52A0\u6210\u529F",type:"success"})}).catch(()=>{this.loading=!1})}})},handleCloseDialog:function(){this.dialogVisible=!1,this.editForm={name:"",remark:"",resources:[]},this.$refs.editForm&&this.$refs.editForm.resetFields()},remove(s){if(!s||!s.id)return null;this.$confirm("\u662F\u5426\u5220\u9664?","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{this.loading=!0,N({id:s.id}).then(()=>{this.fetchData(),this.$message({message:"\u5220\u9664\u6210\u529F",type:"success"})}).catch(()=>{this.loading=!1})})},fetchData:function(){this.loading=!0,q().then(s=>{this.loading=!1,this.list=s.data}).catch(()=>{this.loading=!1})}},created:function(){this.fetchData()}},L=a(" \u6DFB\u52A0 "),O=a("\u7F16\u8F91"),j=a("\u5220\u9664"),z=a("\u786E \u5B9A"),G=a("\u53D6 \u6D88");function H(s,t,v,J,e,d){const V=r("plus"),C=r("el-icon"),n=r("el-button"),F=r("ToolBar"),u=r("el-table-column"),x=r("el-table"),g=r("el-input"),_=r("el-form-item"),y=r("TheResourcePicker"),D=r("el-form"),w=r("el-dialog"),f=b("auth"),T=b("loading");return m((c(),P("div",null,[o(F,null,{default:l(()=>[m((c(),h(n,{type:"primary",onClick:t[0]||(t[0]=i=>e.dialogVisible=!0)},{default:l(()=>[o(C,null,{default:l(()=>[o(V)]),_:1}),L]),_:1})),[[f,e.role.add]])]),_:1}),o(x,{data:e.list,style:{width:"100%"}},{default:l(()=>[o(u,{prop:"name",label:"\u89D2\u8272\u540D\u79F0",align:"center"}),o(u,{prop:"remark",label:"\u5907\u6CE8"}),o(u,{label:"\u64CD\u4F5C",width:"300",align:"center"},{default:l(i=>[m((c(),h(n,{type:"info",plain:"",onClick:p=>d.edit(i.row)},{default:l(()=>[O]),_:2},1032,["onClick"])),[[f,e.role.edit]]),m((c(),h(n,{type:"danger",plain:"",onClick:p=>d.remove(i.row)},{default:l(()=>[j]),_:2},1032,["onClick"])),[[f,e.role.remove]])]),_:1})]),_:1},8,["data"]),o(w,{"close-on-click-modal":!1,"custom-class":"comDialog",title:"\u6743\u9650\u4FE1\u606F",modelValue:e.dialogVisible,"onUpdate:modelValue":t[5]||(t[5]=i=>e.dialogVisible=i),width:"600px",onClose:d.handleCloseDialog},{footer:l(()=>[o(n,{type:"primary",onClick:d.save},{default:l(()=>[z]),_:1},8,["onClick"]),o(n,{onClick:t[4]||(t[4]=i=>e.dialogVisible=!1)},{default:l(()=>[G]),_:1})]),default:l(()=>[o(D,{ref:"editForm",rules:e.rules,model:e.editForm,"label-width":"80px"},{default:l(()=>[o(_,{label:"\u89D2\u8272\u540D\u79F0",prop:"name"},{default:l(()=>[o(g,{modelValue:e.editForm.name,"onUpdate:modelValue":t[1]||(t[1]=i=>e.editForm.name=i),modelModifiers:{trim:!0},maxlength:100},null,8,["modelValue"])]),_:1}),o(_,{label:"\u5907\u6CE8",prop:"remark"},{default:l(()=>[o(g,{modelValue:e.editForm.remark,"onUpdate:modelValue":t[2]||(t[2]=i=>e.editForm.remark=i),modelModifiers:{trim:!0},type:"textarea",maxlength:1e3},null,8,["modelValue"])]),_:1}),o(_,{label:"\u6743\u9650"},{default:l(()=>[o(y,{picker:"",checked:e.editForm.resources,onCheck:t[3]||(t[3]=i=>e.editForm.resources=i.map(p=>p.id))},null,8,["checked"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue","onClose"])])),[[T,e.loading]])}var S=B(I,[["render",H]]);export{S as default};
