import{_ as e,r as a}from"./index.e5690914.js";import{r as l,o as t,t as r,v as s,b as o,w as i,aU as d,ax as n,aV as u,aW as m}from"./ui.7155d707.js";const p=function(e={}){let a=e.value;return"function"==typeof a&&(a=a()),e.label||(e.label={mobile:"手机号",idCard:"身份证号",tel:"电话",email:"邮箱"}[e.validType]||""),new Promise(((l,t)=>{if(null==a||!a.length)return e.required?t(`请输入${e.label}`):l();switch(e.validType){case"mobile":/^(?:(?:\+|00)86)?1\d{10}$/.test(String(a))?l():t(`${e.label}格式有误，请重新输入`);break;case"idCard":(e=>/^[1-9]\d{5}(?:18|19|20)\d{2}(?:0[1-9]|10|11|12)(?:0[1-9]|[1-2]\d|30|31)\d{3}[\dXx]$/.test(String(e)))(a)?l():t(`${e.label}格式有误，请重新输入`);break;case"tel":(e=>/^(?:(?:\d{3}-)?\d{8}|^(?:\d{4}-)?\d{7,8})(?:-\d+)?$/.test(String(e)))(a)?l():t(`${e.label}格式有误，请重新输入`);break;case"email":(e=>/^[A-Za-z0-9\u4e00-\u9fa5]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/.test(String(e)))(a)?l():t(`${e.label}格式有误，请重新输入`);break;default:t(`不支持的validType: ${e.validType}`)}}))},f={data(){return{loading:!1,formData:{mobile:null,token:null,name:null,company:null,password:null,checkPass:null,userInput:null},rules:{mobile:[{validator:()=>p({required:!0,validType:"mobile",value:()=>{var e;return null==(e=this.formData)?void 0:e.mobile}}),trigger:[]}],userInput:[{validator:()=>new Promise(((e,a)=>{this.$refs.InputSMS.valid().then((a=>{this.resData=a,e()})).catch((e=>{a(e)}))})),trigger:[]}],name:[{required:!0,message:"请输入姓名",trigger:"change"}],company:[{required:!0,message:"请输入工作单位",trigger:"change"}],password:[{validator:(e,a,l)=>{""===a?l(new Error("请输入密码")):(""!==this.formData.checkPass&&this.$refs.validForm.validateField("checkPass"),l())},trigger:"blur"},{min:6,max:30,message:"长度在 6 到 30 个字符",trigger:"blur"}],checkPass:[{validator:(e,a,l)=>{""===a?l(new Error("请再次输入密码")):a!==this.formData.password?l(new Error("两次输入密码不一致!")):l()},trigger:"blur"}]},resData:null}},methods:{sendValidCode(){this.$refs.validForm.validateField("mobile",(e=>{e||this.$refs.InputSMS.send()}))},register(){if(this.loading)return null;this.loading=!0,this.$refs.validForm.validate((async e=>{e?(this.formData.token=this.resData,a(this.formData).then((e=>{this.loading=!1,200===e.status?this.$alert("注册成功,请登录","注册成功",{confirmButtonText:"确定",callback:()=>{this.$router.replace({name:"登录"})}}):this.$message.error(e.data.message)})).catch((()=>{this.loading=!1}))):this.loading=!1}))}},created(){}},c=e=>(u("data-v-341d3655"),e=e(),m(),e),b={class:"flex-row align-center justify-center registerPage"},g={class:"register-box"},h=c((()=>s("div",{class:"title"},"注册账号",-1))),v=n("确 认"),D={class:"flex-row"},y=c((()=>s("div",{class:"flex-1"},null,-1))),k=n(" 已有账号？"),$=n(" 点击登录 ");const w=e(f,[["render",function(e,a,n,u,m,p){const f=l("el-input"),c=l("el-form-item"),w=l("InputSMS"),V=l("InputPassword"),_=l("el-button"),S=l("el-form"),x=l("el-link"),P=l("auth");return t(),r("div",b,[s("div",g,[h,o(S,{ref:"validForm",model:m.formData,rules:m.rules,"label-width":"100px","hide-required-asterisk":"",onSubmit:d(p.register,["prevent"]),size:"medium"},{default:i((()=>[o(c,{prop:"mobile",required:"",label:"手机号："},{default:i((()=>[o(f,{modelValue:m.formData.mobile,"onUpdate:modelValue":a[0]||(a[0]=e=>m.formData.mobile=e)},null,8,["modelValue"])])),_:1}),o(c,{prop:"userInput",label:"验证码："},{default:i((()=>[o(w,{ref:"InputSMS",type:"register",mobile:m.formData.mobile,onClick:p.sendValidCode},null,8,["mobile","onClick"])])),_:1}),o(c,{prop:"name",label:"姓名："},{default:i((()=>[o(f,{modelValue:m.formData.name,"onUpdate:modelValue":a[1]||(a[1]=e=>m.formData.name=e),modelModifiers:{trim:!0}},null,8,["modelValue"])])),_:1}),o(c,{prop:"company",label:"工作单位："},{default:i((()=>[o(f,{modelValue:m.formData.company,"onUpdate:modelValue":a[2]||(a[2]=e=>m.formData.company=e),modelModifiers:{trim:!0}},null,8,["modelValue"])])),_:1}),o(c,{prop:"password",label:"设置密码："},{default:i((()=>[o(V,{modelValue:m.formData.password,"onUpdate:modelValue":a[3]||(a[3]=e=>m.formData.password=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),o(c,{prop:"checkPass",label:"重复密码："},{default:i((()=>[o(f,{type:"password",modelValue:m.formData.checkPass,"onUpdate:modelValue":a[4]||(a[4]=e=>m.formData.checkPass=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),o(c,{class:"submit-item"},{default:i((()=>[o(_,{"native-type":"submit",class:"submit-button",type:"primary",loading:m.loading},{default:i((()=>[v])),_:1},8,["loading"])])),_:1})])),_:1},8,["model","rules","onSubmit"]),s("div",D,[y,k,o(x,{type:"danger",class:"first",onClick:a[5]||(a[5]=a=>e.$router.push({name:"登录"}))},{default:i((()=>[$])),_:1})])]),o(P,{ref:"auth",types:["captcha"]},null,512)])}],["__scopeId","data-v-341d3655"]]);export{w as default};
