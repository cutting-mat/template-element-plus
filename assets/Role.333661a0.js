import{d as e,a as l,_ as a}from"./index.3253e0ab.js";import{r as i,a as t,e as o,b as s,l as r}from"./role.55f69842.js";import{q as d,r as n,aU as m,aV as c,o as u,t as h,b as f,w as g,a as p,ax as b}from"./ui.9933098f.js";const k={components:{TheResourcePicker:d((()=>l((()=>import("./TheResourcePicker.07340bc2.js")),["assets/TheResourcePicker.07340bc2.js","assets/index.3253e0ab.js","assets/ui.9933098f.js","assets/index.58490702.css","assets/resource.542c9c94.js","assets/TheResourcePicker.47bd3db8.css"])))},data:()=>({role:i,dialogVisible:!1,loading:!1,list:[],editForm:{name:"",remark:"",resources:[]},rules:{name:[{required:!0,message:"请输入角色名称",trigger:"blur"},{min:1,max:100,message:"长度 1 到 100 个字符",trigger:"blur"}],remark:[{min:0,max:255,message:"长度 0 到 255 个字符",trigger:"blur"}]}}),methods:{edit(l){this.editForm=e(l),this.editForm.resources=l.resources,this.dialogVisible=!0},save(){this.$refs.editForm.validate((l=>{if(l){this.loading=!0;let l=e(this.editForm);this.handleCloseDialog(),(l.id?o:t)(l).then((()=>{this.fetchData(),this.$message({message:"添加成功",type:"success"})})).catch((()=>{this.loading=!1}))}}))},handleCloseDialog:function(){this.dialogVisible=!1,this.editForm={name:"",remark:"",resources:[]},this.$refs.editForm&&this.$refs.editForm.resetFields()},remove(e){if(!e||!e.id)return null;this.$confirm("是否删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.loading=!0,s({id:e.id}).then((()=>{this.fetchData(),this.$message({message:"删除成功",type:"success"})})).catch((()=>{this.loading=!1}))}))},fetchData:function(){this.loading=!0,r().then((e=>{this.loading=!1,this.list=e.data})).catch((()=>{this.loading=!1}))}},created:function(){this.fetchData()}},_={class:"scrollbar"};const V=a(k,[["render",function(e,l,a,i,t,o){const s=n("plus"),r=n("el-icon"),d=n("el-button"),k=n("ToolBar"),V=n("el-table-column"),F=n("el-table"),C=n("el-input"),x=n("el-form-item"),y=n("TheResourcePicker"),D=n("el-form"),w=n("el-dialog"),v=m("auth"),T=m("loading");return c((u(),h("div",_,[f(k,null,{default:g((()=>[c((u(),p(d,{type:"primary",onClick:l[0]||(l[0]=e=>t.dialogVisible=!0)},{default:g((()=>[f(r,null,{default:g((()=>[f(s)])),_:1}),b(" 添加 ")])),_:1})),[[v,t.role.add]])])),_:1}),f(F,{data:t.list,style:{width:"100%"}},{default:g((()=>[f(V,{prop:"name",label:"角色名称",align:"center"}),f(V,{prop:"remark",label:"备注"}),f(V,{label:"操作",width:"300",align:"center"},{default:g((e=>[c((u(),p(d,{type:"info",plain:"",onClick:l=>o.edit(e.row)},{default:g((()=>[b("编辑")])),_:2},1032,["onClick"])),[[v,t.role.edit]]),c((u(),p(d,{type:"danger",plain:"",onClick:l=>o.remove(e.row)},{default:g((()=>[b("删除")])),_:2},1032,["onClick"])),[[v,t.role.remove]])])),_:1})])),_:1},8,["data"]),f(w,{"close-on-click-modal":!1,"custom-class":"comDialog",title:"权限信息",modelValue:t.dialogVisible,"onUpdate:modelValue":l[5]||(l[5]=e=>t.dialogVisible=e),width:"600px",onClose:o.handleCloseDialog},{footer:g((()=>[f(d,{type:"primary",onClick:o.save},{default:g((()=>[b("确 定")])),_:1},8,["onClick"]),f(d,{onClick:l[4]||(l[4]=e=>t.dialogVisible=!1)},{default:g((()=>[b("取 消")])),_:1})])),default:g((()=>[f(D,{ref:"editForm",rules:t.rules,model:t.editForm,"label-width":"80px"},{default:g((()=>[f(x,{label:"角色名称",prop:"name"},{default:g((()=>[f(C,{modelValue:t.editForm.name,"onUpdate:modelValue":l[1]||(l[1]=e=>t.editForm.name=e),modelModifiers:{trim:!0},maxlength:100},null,8,["modelValue"])])),_:1}),f(x,{label:"备注",prop:"remark"},{default:g((()=>[f(C,{modelValue:t.editForm.remark,"onUpdate:modelValue":l[2]||(l[2]=e=>t.editForm.remark=e),modelModifiers:{trim:!0},type:"textarea",maxlength:1e3},null,8,["modelValue"])])),_:1}),f(x,{label:"权限"},{default:g((()=>[f(y,{picker:"",checked:t.editForm.resources,onCheck:l[3]||(l[3]=e=>t.editForm.resources=e.map((e=>e.id)))},null,8,["checked"])])),_:1})])),_:1},8,["rules","model"])])),_:1},8,["modelValue","onClose"])])),[[T,t.loading]])}]]);export{V as default};
