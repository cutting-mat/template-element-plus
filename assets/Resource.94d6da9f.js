import{_ as A,D as C,d as g,b as D,r as s,B as E,C as w,o as a,c as F,e as r,k as b,w as i,g as p,F as B,i as M,h as U,a as L,l as h,t as P}from"./index.cc0542f8.js";import{r as _}from"./resource.ad00fe08.js";const N={components:{TheResourcePicker:C(()=>L(()=>import("./TheResourcePicker.ecdc2171.js"),["assets/TheResourcePicker.ecdc2171.js","assets/TheResourcePicker.55cef8ca.css","assets/index.cc0542f8.js","assets/index.43470bb7.css","assets/resource.ad00fe08.js"]))},data(){return{resource:_,loading:!1,list:[],editForm:{pid:null,method:"get",name:"",url:"",type:0},rules:{name:[{required:!0,message:"\u8BF7\u8F93\u5165\u540D\u79F0",trigger:"blur"},{min:1,max:100,message:"\u957F\u5EA6 1 \u5230 100 \u4E2A\u5B57\u7B26",trigger:"blur"}],url:[{required:!0,message:"\u8BF7\u8F93\u5165\u8DEF\u7531/URL",trigger:"blur"}],method:[{validator:(e,m,u)=>{if(this.editForm.type===1&&!m)return u(new Error("\u8BF7\u586B\u5199Method!"));u()},trigger:"blur"}]},requestMethods:[{label:"GET"},{label:"POST"},{label:"PUT"},{label:"DELETE"}]}},methods:{edit:function(o){this.editForm=g(o),this.editForm.method=this.editForm.method.toLowerCase()},append(o){this.editForm={pid:o.id,name:"",route:"",type:0}},addResource(o){this.editForm={pid:o.id,method:"get",name:"",url:"",type:1}},save(){this.$refs.editForm.validate(o=>{if(o){let e=g(this.editForm);const m=_;Array.isArray(e.pid)&&(e.pid=e.pid.pop()),e.method&&(e.method=e.method.toLowerCase()),this.loading=!0,(e.id?m.edit:m.add)(e).then(()=>{this.fetchData(),this.$message({message:"\u6DFB\u52A0\u6210\u529F",type:"success"})}).catch(()=>{this.loading=!1})}})},resetFrom:function(){this.editForm={pid:"",name:"",route:""},this.$refs.editForm&&this.$refs.editForm.resetFields()},remove(o){if(!o||!o.id)return null;const e=_;this.$confirm("\u662F\u5426\u5220\u9664?","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{this.loading=!0,e.remove({id:o.id}).then(()=>{this.fetchData(),this.$message({message:"\u5220\u9664\u6210\u529F",type:"success"})}).catch(()=>{this.loading=!1})})},fetchData:function(){this.loading=!0,this.$store.getPermission({cache:"update"}).then(o=>{this.loading=!1,this.list=D(o.menus.concat(o.resources))}).catch(()=>{this.loading=!1})}},created:function(){this.fetchData()}},q={class:"flex-col scrollbar"},S={class:"flex-1 flex-row"},I={class:"resourceWrap flex-1 scrollbar"},O=h("\u4FDD \u5B58"),G=h("\u91CD \u7F6E");function W(o,e,m,u,t,n){const v=s("ToolBar"),y=s("TheResourcePicker"),c=s("el-input"),d=s("el-form-item"),V=s("el-radio"),k=s("el-radio-group"),x=s("el-cascader"),f=s("el-button"),R=s("el-form"),T=E("loading");return w((a(),F("div",q,[r(v),b("div",S,[b("div",I,[r(y,{listdata:t.list,onEdit:n.edit,onAppend:n.append,onAddResource:n.addResource,onRemove:n.remove},null,8,["listdata","onEdit","onAppend","onAddResource","onRemove"])]),r(R,{class:"resourceEditFrom",ref:"editForm",rules:t.rules,model:t.editForm,"label-width":"80px"},{default:i(()=>[r(d,{label:"\u540D\u79F0",prop:"name"},{default:i(()=>[r(c,{modelValue:t.editForm.name,"onUpdate:modelValue":e[0]||(e[0]=l=>t.editForm.name=l),modelModifiers:{trim:!0},maxlength:100},null,8,["modelValue"])]),_:1}),t.editForm.type===1?(a(),p(d,{key:0,label:"\u65B9\u6CD5",prop:"method"},{default:i(()=>[r(k,{modelValue:t.editForm.method,"onUpdate:modelValue":e[1]||(e[1]=l=>t.editForm.method=l)},{default:i(()=>[(a(!0),F(B,null,M(t.requestMethods,(l,j)=>(a(),p(V,{label:l.label.toLowerCase()},{default:i(()=>[h(P(l.label),1)]),_:2},1032,["label"]))),256))]),_:1},8,["modelValue"])]),_:1})):U("",!0),t.editForm.type===1?(a(),p(d,{key:1,label:"URL",prop:"url"},{default:i(()=>[r(c,{modelValue:t.editForm.url,"onUpdate:modelValue":e[2]||(e[2]=l=>t.editForm.url=l),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1})):(a(),p(d,{key:2,label:"\u8DEF\u7531",prop:"route"},{default:i(()=>[r(c,{modelValue:t.editForm.route,"onUpdate:modelValue":e[3]||(e[3]=l=>t.editForm.route=l),modelModifiers:{trim:!0},maxlength:100},null,8,["modelValue"])]),_:1})),r(d,{label:"\u7236\u7EA7"},{default:i(()=>[r(x,{modelValue:t.editForm.pid,"onUpdate:modelValue":e[4]||(e[4]=l=>t.editForm.pid=l),options:t.list,props:{checkStrictly:!0,label:"name",value:"id"}},null,8,["modelValue","options"])]),_:1}),r(d,{label:"\u5E8F\u53F7"},{default:i(()=>[r(c,{modelValue:t.editForm.orderNum,"onUpdate:modelValue":e[5]||(e[5]=l=>t.editForm.orderNum=l),modelModifiers:{trim:!0},type:"number"},null,8,["modelValue"])]),_:1}),r(d,null,{default:i(()=>[r(f,{type:"primary",onClick:n.save},{default:i(()=>[O]),_:1},8,["onClick"]),r(f,{onClick:n.resetFrom},{default:i(()=>[G]),_:1},8,["onClick"])]),_:1})]),_:1},8,["rules","model"])])])),[[T,t.loading]])}const J=A(N,[["render",W],["__scopeId","data-v-9e327008"]]);export{J as default};
