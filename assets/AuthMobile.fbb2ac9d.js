import{_ as g,N as M,O as C,P as V,r,o as p,g as _,w as i,l as m,t as v,h as w,e as n}from"./index.07ef7170.js";const y={props:{command:{type:String,required:!1}},data(){return{loading:!1,formData:{id:null,userInput:null,inputMobile:null},rules:{inputMobile:[{validator:(e,o,l)=>{if(!o)l(new Error("\u8BF7\u8F93\u5165\u7ED1\u5B9A\u624B\u673A"));else{if(this.userMobile&&this.userMobile!==o)return l(new Error("\u624B\u673A\u53F7\u4E0D\u6B63\u786E"));l()}},trigger:[]}],userInput:[{required:!0,message:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",trigger:"blur"},{min:4,max:6,message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u9A8C\u8BC1\u7801",trigger:"blur"}]}}},computed:{userMobile(){return String(this.$store.state.user.contactNumber||"")},anonymousMobile(){if(this.userMobile){const t=this.userMobile.split("");return`${t.map((o,l)=>l<3||t.length-l<3?o:"*").join("")}`}return""}},methods:{sendValidCode(){this.$refs.form.validateField("inputMobile",t=>{t&&(this.loading=!0,(this.command==="reset-pw"?M:C)({mobile:this.formData.inputMobile}).then(o=>{this.loading=!1,o.status===200?(this.formData.id=o.data.id,this.$refs.countdownButton.start()):this.$message.warning("\u9A8C\u8BC1\u7801\u53D1\u9001\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5")}).catch(()=>{this.loading=!1}))})},handleSubmit(){this.$refs.form.validateField("userInput",t=>{t&&(this.loading=!0,V(this.formData).then(e=>{this.loading=!1,e.status===200?this.$emit("success",e.data):(this.$refs.form.resetFields(),this.$message.warning("\u9A8C\u8BC1\u5931\u8D25"))}).catch(()=>{this.loading=!1}))})}}},D=m(" \u83B7\u53D6\u9A8C\u8BC1\u7801 "),x=m(" \u7ACB\u5373\u9A8C\u8BC1 ");function I(t,e,o,l,s,a){const u=r("el-form-item"),f=r("el-input"),c=r("CountdownButton"),h=r("el-button"),b=r("el-form");return p(),_(b,{ref:"form",model:s.formData,rules:s.rules,"label-position":"left",class:"auth_mobile","v-loading":s.loading},{default:i(()=>[a.anonymousMobile?(p(),_(u,{key:0},{default:i(()=>[m("\u7ED1\u5B9A\u624B\u673A\uFF1A"+v(a.anonymousMobile),1)]),_:1})):w("",!0),n(u,{prop:"inputMobile"},{default:i(()=>[n(f,{size:"large",modelValue:s.formData.inputMobile,"onUpdate:modelValue":e[0]||(e[0]=d=>s.formData.inputMobile=d),placeholder:"\u8BF7\u8F93\u5165\u7ED1\u5B9A\u624B\u673A"},null,8,["modelValue"])]),_:1}),n(u,{prop:"userInput"},{default:i(()=>[n(f,{size:"large",modelValue:s.formData.userInput,"onUpdate:modelValue":e[1]||(e[1]=d=>s.formData.userInput=d),placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"},{append:i(()=>[n(c,{ref:"countdownButton",count:30,onClick:a.sendValidCode},{default:i(()=>[D]),_:1},8,["onClick"])]),_:1},8,["modelValue"])]),_:1}),n(u,null,{default:i(()=>[n(h,{type:"primary",size:"large",style:{width:"100%"},onClick:a.handleSubmit},{default:i(()=>[x]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules","v-loading"])}var B=g(y,[["render",I],["__scopeId","data-v-0fa793ba"]]);export{B as default};
