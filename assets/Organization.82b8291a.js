import{_ as e,d as l,a}from"./index.711114fb.js";import{o as i,a as o,e as t,r as s}from"./org.484cc44d.js";import{q as d,r,aX as n,aY as m,o as u,t as g,b as c,w as f,a as h,aC as p,v as _,ax as b}from"./ui.7155d707.js";const V={components:{OrgTree:d((()=>a((()=>import("./OrgTree.11484898.js")),["assets/OrgTree.11484898.js","assets/org.484cc44d.js","assets/index.711114fb.js","assets/index.43470bb7.css","assets/ui.7155d707.js"])))},data:()=>({org:i,dialogVisible:!1,sourceDepart:null,loading:!1,list:[],queryParam:{},editForm:{name:"",pid:null},rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"},{min:1,max:100,message:"长度 1 到 100 个字符",trigger:"blur"}],fullName:[{min:0,max:255,message:"长度 0 到 255 个字符",trigger:"blur"}]},refresh:!0}),methods:{edit(e){this.editForm=l(e),this.dialogVisible=!0},add(e){this.editForm={pid:e.pid},this.dialogVisible=!0},save(){let e=this;e.$refs.editForm.validate((a=>{if(a){let a=l(e.editForm);this.handleCloseDialog(),a.id?t(a).then((()=>{e.fetchData(),e.$message({message:"编辑成功",type:"success"})})):o(a).then((()=>{e.fetchData(),e.$message({message:"添加成功",type:"success"})}))}}))},handleCloseDialog:function(){this.dialogVisible=!1,this.editForm={name:"",pid:null}},remove(e){if(!e||!e.id)return null;this.$confirm("是否删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.loading=!0,s({id:e.id}).then((()=>{this.loading=!1,this.fetchData(),this.$message({message:"删除成功",type:"success"})})).catch((()=>{this.loading=!1}))}))},fetchData(){this.refresh=!1,this.$nextTick((()=>{this.refresh=!0}))}}},C={class:"scrollbar"},k=b(" 添加根节点 "),F=b("编辑"),y=b("添加下级"),v=b("删除"),x=b("确 定"),D=b("取 消");const T=e(V,[["render",function(e,l,a,i,o,t){const s=r("plus"),d=r("el-icon"),b=r("el-button"),V=r("ToolBar"),T=r("OrgTree"),w=r("el-input"),$=r("el-form-item"),j=r("el-form"),N=r("el-dialog"),O=n("auth"),q=n("loading");return m((u(),g("div",C,[c(V,null,{default:f((()=>[m((u(),h(b,{type:"primary",onClick:l[0]||(l[0]=e=>o.dialogVisible=!0)},{default:f((()=>[c(d,null,{default:f((()=>[c(s)])),_:1}),k])),_:1})),[[O,o.org.add]])])),_:1}),o.refresh?(u(),h(T,{key:0},{action:f((e=>[_("div",null,[m((u(),h(b,{onClick:l=>t.edit(e.row)},{default:f((()=>[F])),_:2},1032,["onClick"])),[[O,o.org.edit]]),m((u(),h(b,{onClick:l=>t.add(e.row)},{default:f((()=>[y])),_:2},1032,["onClick"])),[[O,o.org.add]]),m((u(),h(b,{type:"danger",plain:"",onClick:l=>t.remove(e.row)},{default:f((()=>[v])),_:2},1032,["onClick"])),[[O,o.org.remove]])])])),_:1})):p("",!0),c(N,{modelValue:o.dialogVisible,"onUpdate:modelValue":l[5]||(l[5]=e=>o.dialogVisible=e),title:"组织信息",width:"800px","close-on-click-modal":!1,onClose:t.handleCloseDialog},{footer:f((()=>[_("div",null,[c(b,{type:"primary",onClick:l[3]||(l[3]=e=>t.save())},{default:f((()=>[x])),_:1}),c(b,{onClick:l[4]||(l[4]=e=>o.dialogVisible=!1)},{default:f((()=>[D])),_:1})])])),default:f((()=>[c(j,{ref:"editForm",rules:o.rules,model:o.editForm,"label-width":"150px"},{default:f((()=>[c($,{label:"部门名称",prop:"name"},{default:f((()=>[c(w,{modelValue:o.editForm.name,"onUpdate:modelValue":l[1]||(l[1]=e=>o.editForm.name=e)},null,8,["modelValue"])])),_:1}),c($,{label:"全称",prop:"fullName"},{default:f((()=>[c(w,{modelValue:o.editForm.fullName,"onUpdate:modelValue":l[2]||(l[2]=e=>o.editForm.fullName=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["rules","model"])])),_:1},8,["modelValue","onClose"])])),[[q,o.loading]])}]]);export{T as default};
