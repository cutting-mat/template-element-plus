import{d as e,a as l,_ as a}from"./index.3253e0ab.js";import{o as i,a as o,e as t,r as s}from"./org.885c46e3.js";import{q as r,r as d,aU as n,aV as m,o as u,t as g,b as c,w as f,a as h,aC as p,ax as b,v as V}from"./ui.9933098f.js";const _={components:{OrgTree:r((()=>l((()=>import("./OrgTree.a4a5bbbf.js")),["assets/OrgTree.a4a5bbbf.js","assets/org.885c46e3.js","assets/index.3253e0ab.js","assets/ui.9933098f.js","assets/index.58490702.css"])))},data:()=>({org:i,dialogVisible:!1,sourceDepart:null,loading:!1,list:[],queryParam:{},editForm:{name:"",pid:null},rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"},{min:1,max:100,message:"长度 1 到 100 个字符",trigger:"blur"}],fullName:[{min:0,max:255,message:"长度 0 到 255 个字符",trigger:"blur"}]},refresh:!0}),methods:{edit(l){this.editForm=e(l),this.dialogVisible=!0},add(e){this.editForm={pid:e.pid},this.dialogVisible=!0},save(){let l=this;l.$refs.editForm.validate((a=>{if(a){let a=e(l.editForm);this.handleCloseDialog(),a.id?t(a).then((()=>{l.fetchData(),l.$message({message:"编辑成功",type:"success"})})):o(a).then((()=>{l.fetchData(),l.$message({message:"添加成功",type:"success"})}))}}))},handleCloseDialog:function(){this.dialogVisible=!1,this.editForm={name:"",pid:null}},remove(e){if(!e||!e.id)return null;this.$confirm("是否删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.loading=!0,s({id:e.id}).then((()=>{this.loading=!1,this.fetchData(),this.$message({message:"删除成功",type:"success"})})).catch((()=>{this.loading=!1}))}))},fetchData(){this.refresh=!1,this.$nextTick((()=>{this.refresh=!0}))}}},C={class:"scrollbar"};const k=a(_,[["render",function(e,l,a,i,o,t){const s=d("plus"),r=d("el-icon"),_=d("el-button"),k=d("ToolBar"),F=d("OrgTree"),y=d("el-input"),v=d("el-form-item"),x=d("el-form"),D=d("el-dialog"),T=n("auth"),w=n("loading");return m((u(),g("div",C,[c(k,null,{default:f((()=>[m((u(),h(_,{type:"primary",onClick:l[0]||(l[0]=e=>o.dialogVisible=!0)},{default:f((()=>[c(r,null,{default:f((()=>[c(s)])),_:1}),b(" 添加根节点 ")])),_:1})),[[T,o.org.add]])])),_:1}),o.refresh?(u(),h(F,{key:0},{action:f((e=>[V("div",null,[m((u(),h(_,{onClick:l=>t.edit(e.row)},{default:f((()=>[b("编辑")])),_:2},1032,["onClick"])),[[T,o.org.edit]]),m((u(),h(_,{onClick:l=>t.add(e.row)},{default:f((()=>[b("添加下级")])),_:2},1032,["onClick"])),[[T,o.org.add]]),m((u(),h(_,{type:"danger",plain:"",onClick:l=>t.remove(e.row)},{default:f((()=>[b("删除")])),_:2},1032,["onClick"])),[[T,o.org.remove]])])])),_:1})):p("",!0),c(D,{modelValue:o.dialogVisible,"onUpdate:modelValue":l[5]||(l[5]=e=>o.dialogVisible=e),title:"组织信息",width:"800px","close-on-click-modal":!1,onClose:t.handleCloseDialog},{footer:f((()=>[V("div",null,[c(_,{type:"primary",onClick:l[3]||(l[3]=e=>t.save())},{default:f((()=>[b("确 定")])),_:1}),c(_,{onClick:l[4]||(l[4]=e=>o.dialogVisible=!1)},{default:f((()=>[b("取 消")])),_:1})])])),default:f((()=>[c(x,{ref:"editForm",rules:o.rules,model:o.editForm,"label-width":"150px"},{default:f((()=>[c(v,{label:"部门名称",prop:"name"},{default:f((()=>[c(y,{modelValue:o.editForm.name,"onUpdate:modelValue":l[1]||(l[1]=e=>o.editForm.name=e)},null,8,["modelValue"])])),_:1}),c(v,{label:"全称",prop:"fullName"},{default:f((()=>[c(y,{modelValue:o.editForm.fullName,"onUpdate:modelValue":l[2]||(l[2]=e=>o.editForm.fullName=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["rules","model"])])),_:1},8,["modelValue","onClose"])])),[[w,o.loading]])}]]);export{k as default};
