import{c as e,d as i,n as t,o as l,p as a,q as d,b as o,_ as s}from"./index.3253e0ab.js";import{r,aU as n,o as u,a as m,w as c,aV as h,t as p,b as f,ax as g,v as C}from"./ui.9933098f.js";const b={props:{visible:{type:Boolean,required:!1,default:!1},dictCode:{type:String,required:!1}},data(){return{isVisible:this.visible,dict:e,loading:!0,dialogVisible:!1,queryParam:{dictCode:""},list:[],editForm:{pid:"",value:"",dictCode:""},rules:{value:[{required:!0,message:"请输入数据值",trigger:"blur"},{min:1,max:100,message:"长度 1 到 100 个字符",trigger:"blur"}],dictCode:[{min:1,max:100,message:"长度 1 到 100 个字符",trigger:"blur"}]}}},watch:{dictCode:{handler(){this.queryParam.dictCode=this.dictCode},immediate:!0}},methods:{append(e){this.editForm.pid=e.id,this.dialogVisible=!0},edit(e){const i=Object.assign({},e);this.editForm=i,this.dialogVisible=!0},save(){this.$refs.editForm.validate((e=>{if(e){let e=i(this.editForm);e.dictCode=this.queryParam.dictCode,this.handleCloseDialog(),this.loading=!0,e.id?l(e).then((()=>{this.fetchData(),this.$message({message:"编辑成功",type:"success"})})):t(e).then((()=>{this.fetchData(),this.$message({message:"添加成功",type:"success"})}))}}))},remove(e){if(!e)return null;this.$confirm("是否删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{a({id:e.id}).then((()=>{this.fetchData(),this.$message({message:"删除成功",type:"success"})}))}))},handleCloseDialog:function(){this.editForm={pid:"",value:"",dictCode:""},this.dialogVisible=!1},requireClose(){this.list=[],this.$emit("close")},fetchData(){this.loading=!0,d(this.queryParam).then((e=>{this.loading=!1,this.list=o(e.data)}))},handleInit(){this.queryParam.dictCode&&this.fetchData()}},created(){}},V={class:"flex-col myform"},v={class:"flex-1 scrollbar"};const y=s(b,[["render",function(e,i,t,l,a,d){const o=r("plus"),s=r("el-icon"),b=r("el-button"),y=r("ToolBar"),_=r("el-table-column"),k=r("el-table"),x=r("el-input"),w=r("el-form-item"),q=r("el-form"),F=r("el-dialog"),D=r("el-drawer"),$=n("auth"),O=n("loading");return u(),m(D,{modelValue:a.isVisible,"onUpdate:modelValue":i[5]||(i[5]=e=>a.isVisible=e),direction:"rtl",size:"900px",withHeader:!1,onOpened:d.handleInit,onClose:d.requireClose},{default:c((()=>[h((u(),p("div",V,[f(y,{title:"字典数据维护",back:d.requireClose},{default:c((()=>[h((u(),m(b,{type:"primary",onClick:i[0]||(i[0]=e=>a.dialogVisible=!0)},{default:c((()=>[f(s,null,{default:c((()=>[f(o)])),_:1}),g(" 添加数据 ")])),_:1})),[[$,a.dict.itemAdd]])])),_:1},8,["back"]),C("div",v,[f(k,{data:a.list,style:{width:"100%","margin-bottom":"20px"},"row-key":"id",border:"","default-expand-all":""},{default:c((()=>[f(_,{prop:"value",label:"值"}),f(_,{prop:"dictCode",label:"CODE",align:"center"}),f(_,{label:"操作",width:"300",align:"center"},{default:c((e=>[h((u(),m(b,{onClick:i=>d.edit(e.row)},{default:c((()=>[g("编辑")])),_:2},1032,["onClick"])),[[$,a.dict.itemEdit]]),h((u(),m(b,{onClick:i=>d.append(e.row)},{default:c((()=>[g("添加下级")])),_:2},1032,["onClick"])),[[$,a.dict.itemEdit]]),h((u(),m(b,{type:"danger",plain:"",onClick:i=>d.remove(e.row)},{default:c((()=>[g("删除")])),_:2},1032,["onClick"])),[[$,a.dict.itemRemove]])])),_:1})])),_:1},8,["data"])]),f(F,{"close-on-click-modal":!1,title:"字典数据",modelValue:a.dialogVisible,"onUpdate:modelValue":i[4]||(i[4]=e=>a.dialogVisible=e),width:"600px","append-to-body":"",onClose:d.handleCloseDialog},{footer:c((()=>[C("div",null,[f(b,{type:"primary",onClick:d.save},{default:c((()=>[g("确 定")])),_:1},8,["onClick"]),f(b,{onClick:i[3]||(i[3]=e=>a.dialogVisible=!1)},{default:c((()=>[g("取 消")])),_:1})])])),default:c((()=>[f(q,{ref:"editForm",rules:a.rules,model:a.editForm,"label-width":"80px"},{default:c((()=>[f(w,{label:"值",prop:"value"},{default:c((()=>[f(x,{modelValue:a.editForm.value,"onUpdate:modelValue":i[1]||(i[1]=e=>a.editForm.value=e)},null,8,["modelValue"])])),_:1}),f(w,{label:"CODE",prop:"dictCode"},{default:c((()=>[f(x,{modelValue:a.editForm.dictCode,"onUpdate:modelValue":i[2]||(i[2]=e=>a.editForm.dictCode=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["rules","model"])])),_:1},8,["modelValue","onClose"])])),[[O,a.loading]])])),_:1},8,["modelValue","onOpened","onClose"])}],["__scopeId","data-v-02a369e9"]]);export{y as default};
