import{d as e,b as t,a as o,_ as l}from"./index.3253e0ab.js";import{r as a}from"./resource.542c9c94.js";import{q as r,r as d,aU as i,aV as s,o as m,t as u,b as n,v as c,w as p,a as h,aA as f,aB as g,aC as F,ax as b,ay as V}from"./ui.9933098f.js";const _={components:{TheResourcePicker:r((()=>o((()=>import("./TheResourcePicker.07340bc2.js")),["assets/TheResourcePicker.07340bc2.js","assets/index.3253e0ab.js","assets/ui.9933098f.js","assets/index.58490702.css","assets/resource.542c9c94.js","assets/TheResourcePicker.47bd3db8.css"])))},data(){return{resource:a,loading:!1,list:[],editForm:{pid:null,method:"get",name:"",url:"",type:0},rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"},{min:1,max:100,message:"长度 1 到 100 个字符",trigger:"blur"}],url:[{required:!0,message:"请输入路由/URL",trigger:"blur"}],method:[{validator:(e,t,o)=>{if(1===this.editForm.type&&!t)return o(new Error("请填写Method!"));o()},trigger:"blur"}]},requestMethods:[{label:"GET"},{label:"POST"},{label:"PUT"},{label:"DELETE"}]}},methods:{edit:function(t){this.editForm=e(t),this.editForm.method=this.editForm.method.toLowerCase()},append(e){this.editForm={pid:e.id,name:"",route:"",type:0}},addResource(e){this.editForm={pid:e.id,method:"get",name:"",url:"",type:1}},save(){this.$refs.editForm.validate((t=>{if(t){let t=e(this.editForm);const o=a;Array.isArray(t.pid)&&(t.pid=t.pid.pop()),t.method&&(t.method=t.method.toLowerCase()),this.loading=!0,(t.id?o.edit:o.add)(t).then((()=>{this.fetchData(),this.$message({message:"添加成功",type:"success"})})).catch((()=>{this.loading=!1}))}}))},resetFrom:function(){this.editForm={pid:"",name:"",route:""},this.$refs.editForm&&this.$refs.editForm.resetFields()},remove(e){if(!e||!e.id)return null;const t=a;this.$confirm("是否删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.loading=!0,t.remove({id:e.id}).then((()=>{this.fetchData(),this.$message({message:"删除成功",type:"success"})})).catch((()=>{this.loading=!1}))}))},fetchData:function(){this.loading=!0,this.$store.getPermission({cache:"update"}).then((e=>{this.loading=!1,this.list=t(e.menus.concat(e.resources))})).catch((()=>{this.loading=!1}))}},created:function(){this.fetchData()}},y={class:"flex-col scrollbar"},v={class:"flex-1 flex-row"},x={class:"resourceWrap flex-1 scrollbar"};const R=l(_,[["render",function(e,t,o,l,a,r){const _=d("ToolBar"),R=d("TheResourcePicker"),k=d("el-input"),T=d("el-form-item"),E=d("el-radio"),U=d("el-radio-group"),w=d("el-cascader"),A=d("el-button"),C=d("el-form"),L=i("loading");return s((m(),u("div",y,[n(_),c("div",v,[c("div",x,[n(R,{listdata:a.list,onEdit:r.edit,onAppend:r.append,onAddResource:r.addResource,onRemove:r.remove},null,8,["listdata","onEdit","onAppend","onAddResource","onRemove"])]),n(C,{class:"resourceEditFrom",ref:"editForm",rules:a.rules,model:a.editForm,"label-width":"80px"},{default:p((()=>[n(T,{label:"名称",prop:"name"},{default:p((()=>[n(k,{modelValue:a.editForm.name,"onUpdate:modelValue":t[0]||(t[0]=e=>a.editForm.name=e),modelModifiers:{trim:!0},maxlength:100},null,8,["modelValue"])])),_:1}),1===a.editForm.type?(m(),h(T,{key:0,label:"方法",prop:"method"},{default:p((()=>[n(U,{modelValue:a.editForm.method,"onUpdate:modelValue":t[1]||(t[1]=e=>a.editForm.method=e)},{default:p((()=>[(m(!0),u(f,null,g(a.requestMethods,((e,t)=>(m(),h(E,{label:e.label.toLowerCase()},{default:p((()=>[b(V(e.label),1)])),_:2},1032,["label"])))),256))])),_:1},8,["modelValue"])])),_:1})):F("",!0),1===a.editForm.type?(m(),h(T,{key:1,label:"URL",prop:"url"},{default:p((()=>[n(k,{modelValue:a.editForm.url,"onUpdate:modelValue":t[2]||(t[2]=e=>a.editForm.url=e),modelModifiers:{trim:!0}},null,8,["modelValue"])])),_:1})):(m(),h(T,{key:2,label:"路由",prop:"route"},{default:p((()=>[n(k,{modelValue:a.editForm.route,"onUpdate:modelValue":t[3]||(t[3]=e=>a.editForm.route=e),modelModifiers:{trim:!0},maxlength:100},null,8,["modelValue"])])),_:1})),n(T,{label:"父级"},{default:p((()=>[n(w,{modelValue:a.editForm.pid,"onUpdate:modelValue":t[4]||(t[4]=e=>a.editForm.pid=e),options:a.list,props:{checkStrictly:!0,label:"name",value:"id"}},null,8,["modelValue","options"])])),_:1}),n(T,{label:"序号"},{default:p((()=>[n(k,{modelValue:a.editForm.orderNum,"onUpdate:modelValue":t[5]||(t[5]=e=>a.editForm.orderNum=e),modelModifiers:{trim:!0},type:"number"},null,8,["modelValue"])])),_:1}),n(T,null,{default:p((()=>[n(A,{type:"primary",onClick:r.save},{default:p((()=>[b("保 存")])),_:1},8,["onClick"]),n(A,{onClick:r.resetFrom},{default:p((()=>[b("重 置")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["rules","model"])])])),[[L,a.loading]])}],["__scopeId","data-v-4b6def15"]]);export{R as default};
